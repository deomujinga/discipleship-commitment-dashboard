<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Discipleship 90-Day Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  :root{
    --bg:#f7f9fc; --card:#ffffff; --ink:#1f2937; --muted:#6b7280;
    --ok:#16a34a; --warn:#f59e0b; --bad:#ef4444; --shadow:0 8px 24px rgba(0,0,0,.06);
    --radius:16px;
    --read:#3b82f6;     /* Bible Reading */
    --intimacy:#06b6d4; /* Morning Intimacy */
    --memory:#7c3aed;   /* Scripture Memorization */
    --empty:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
  header{padding:20px 24px 8px;display:flex;justify-content:space-between;align-items:center}
  header h1{margin:0;font-size:clamp(20px,3vw,28px)}
  header .who{color:var(--muted);font-size:14px}
  .wrap{padding:0 24px 40px;max-width:1400px;margin:0 auto}

  /* KPI cards */
  .kpis{
    display:grid; gap:18px; grid-template-columns:repeat(5, 1fr); margin-bottom:24px;
  }
  @media (max-width:1200px){
    .kpis{grid-template-columns:repeat(3, 1fr)}
    .kpis .card:nth-child(4), .kpis .card:nth-child(5){ grid-column:span 1; }
  }
  @media (max-width:768px){
    .kpis{grid-template-columns:repeat(2, 1fr)}
    .kpis .card:nth-child(5){ grid-column:span 2; }
  }
  @media (max-width:480px){ .kpis{grid-template-columns:1fr} }

  .grid{display:grid;gap:18px}
  /* Make Practice Balance a little wider */
  .mid{grid-template-columns:1.4fr 1.8fr}
  .bottom{grid-template-columns:1fr}
  @media (max-width:980px){.mid,.bottom{grid-template-columns:1fr}}

  .card{
    background:var(--card);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:20px;
    min-height:140px;
    display:flex;
    flex-direction:column;
  }
  .card h3{
    margin:0 0 8px; font-size:14px; color:var(--muted); font-weight:600; letter-spacing:.2px; text-transform:uppercase;
  }
  .card h2{font-size:18px;margin:0 0 16px;color:#111827;font-weight:700}
  .big{font-size:clamp(20px,3vw,26px); margin:6px 0 4px; font-weight:800; flex-grow:1; display:flex; align-items:center}
  .sub{font-size:11px;color:var(--muted);line-height:1.4;margin-top:auto}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;border:1px solid #e5e7eb;font-size:11px;font-weight:600;margin-top:6px;width:fit-content}
  .ok{background:#e8f8ee;color:#065f46;border-color:#10b981}
  .warn{background:#fff7e6;color:#92400e;border-color:#f59e0b}
  .bad{background:#fdeaea;color:#991b1b;border-color:#ef4444}
  .section h2{font-size:18px;margin:0 0 12px;color:#111827}
  canvas{width:100%;height:auto;max-height:320px}

  /* Heatmap (shorter height) */
  .heatmap-container{background:#f8fafc;border-radius:12px;padding:12px;border:1px solid #e5e7eb}
  .day-headers{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:6px}
  .day-header{text-align:center;font-size:11px;font-weight:600;color:var(--muted);padding:4px 0}
  .heat-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:3px}
  .day-cell{
    aspect-ratio:.7;min-height:28px; /* reduced height */
    background:#ffffff;border-radius:6px;padding:3px;
    display:grid;grid-template-rows:repeat(3,1fr);gap:2px;
    border:1px solid #e5e7eb;position:relative;transition:all .2s ease
  }
  .day-cell:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.1)}
  .day-cell.empty{background:#f9fafb;border:1px solid #f3f4f6}
  .practice-bar{border-radius:3px;background:var(--empty);display:flex;align-items:center;justify-content:center;position:relative;transition:all .2s ease}
  .practice-bar .practice-label{font-size:7.5px;font-weight:800;color:#6b7280;line-height:1}
  .practice-bar.completed .practice-label{color:#ffffff}
  .practice-bar.read.completed{background:var(--read)}
  .practice-bar.intimacy.completed{background:var(--intimacy)}
  .practice-bar.memory.completed{background:var(--memory)}
  .practice-bar.partial .practice-label{color:#ffffff}
  .practice-bar.read.partial{background:linear-gradient(90deg,var(--read) 0 50%, var(--empty) 50% 100%)}
  .practice-bar.intimacy.partial{background:linear-gradient(90deg,var(--intimacy) 0 50%, var(--empty) 50% 100%)}
  .practice-bar.memory.partial{background:linear-gradient(90deg,var(--memory) 0 50%, var(--empty) 50% 100%)}
  .day-number{position:absolute;top:-5px;right:-5px;background:rgba(255,255,255,.9);border:1px solid #e5e7eb;border-radius:50%;width:14px;height:14px;display:flex;align-items:center;justify-content:center;font-size:7px;font-weight:600;color:var(--muted)}
  .legend{display:flex;align-items:center;gap:16px;margin-top:12px;flex-wrap:wrap;justify-content:center}
  .chip{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.7);padding:6px 12px;border-radius:20px;border:1px solid #e5e7eb}
  .color-swatch{width:16px;height:16px;border-radius:4px;border:1px solid rgba(255,255,255,.3)}
  .chip-label{font-size:12px;font-weight:500;color:var(--ink)}
  .legend-note{width:100%;text-align:center;font-size:10px;color:var(--muted);margin-top:4px}
</style>
</head>
<body>
<header>
  <h1>Discipleship 90-Day Dashboard</h1>
  <div class="who">Participant: <span id="who">—</span></div>
</header>

<div class="wrap">
  <!-- KPI CARDS -->
  <div class="kpis">
    <div class="card">
      <h3>Overall Attainment</h3>
      <div id="attainment" class="big">—</div>
      <div id="attnFlag" class="pill">—</div>
      <div class="sub">Completed so far ÷ possible so far. Target ≥ 95% to succeed by Day 90.</div>
    </div>
    <div class="card">
      <h3>On-Track vs Expected</h3>
      <div id="ontrack" class="big">—</div>
      <div id="ontrackHelp" class="sub">Ahead/behind the 95% pace based on how many units should be done by today.</div>
    </div>
    <div class="card">
      <h3>Days Passed / Left</h3>
      <div id="days" class="big">—</div>
      <div id="period" class="sub"></div>
    </div>
    <div class="card">
      <h3>Weakest Area</h3>
      <div id="weak" class="big">—</div>
      <div class="sub">Per-practice attainment (completed ÷ possible) so far.</div>
    </div>
    <div class="card">
      <h3>Strongest Area</h3>
      <div id="strong" class="big">—</div>
      <div class="sub">Per-practice attainment (completed ÷ possible) so far.</div>
    </div>
  </div>

  <!-- MID -->
  <div class="grid mid section">
    <div class="card"><h2>Weekly Attainment Trend</h2><canvas id="trend"></canvas></div>
    <div class="card"><h2>Practice Balance (Radar)</h2><canvas id="radar"></canvas><div id="projection" class="sub" style="margin-top:8px"></div></div>
  </div>

  <!-- BOTTOM -->
  <div class="grid bottom section" style="margin-top:18px;">
    <div class="card">
      <h2>Daily Consistency Heatmap (last 6 weeks)</h2>
      <div class="heatmap-container">
        <div class="day-headers">
          <div class="day-header">S</div><div class="day-header">M</div><div class="day-header">T</div>
          <div class="day-header">W</div><div class="day-header">T</div><div class="day-header">F</div><div class="day-header">S</div>
        </div>
        <div id="heat" class="heat-grid"></div>
      </div>
      <div class="legend">
        <div class="chip"><div class="color-swatch" style="background:var(--read)"></div><span class="chip-label">Bible Reading</span></div>
        <div class="chip"><div class="color-swatch" style="background:var(--intimacy)"></div><span class="chip-label">Morning Intimacy</span></div>
        <div class="chip"><div class="color-swatch" style="background:var(--memory)"></div><span class="chip-label">Scripture Memorization</span></div>
        <div class="legend-note">Symbols: ✓ = Done (1), ½ = Partial (0–&lt;1), – = Not done (0)</div>
      </div>
    </div>
  </div>
</div>

<script>
/* keep your same JS logic — unchanged */
</script>
</body>
</html>
